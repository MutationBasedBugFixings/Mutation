diff -ruN --exclude .git --exclude .svn --exclude .hg --exclude .idea --exclude .settings --exclude .classpath --exclude .project --exclude target --exclude build --exclude out --exclude bin --exclude '*.class' --exclude '*.jar' --exclude '*.war' --exclude '*.ear' --exclude '*.zip' --exclude '*.tar' --exclude '*.gz' /home1/furqan/my_mutation_experiments/d4j_work_diff/Cli-22-b/.defects4j.config /home1/furqan/my_mutation_experiments/d4j_work_diff/Cli-22-f/.defects4j.config
--- /home1/furqan/my_mutation_experiments/d4j_work_diff/Cli-22-b/.defects4j.config	2025-11-02 23:01:40.808047875 +0800
+++ /home1/furqan/my_mutation_experiments/d4j_work_diff/Cli-22-f/.defects4j.config	2025-11-02 23:01:43.506999822 +0800
@@ -1,3 +1,3 @@
 #File automatically generated by Defects4J
 pid=Cli
-vid=22b
+vid=22f
diff -ruN --exclude .git --exclude .svn --exclude .hg --exclude .idea --exclude .settings --exclude .classpath --exclude .project --exclude target --exclude build --exclude out --exclude bin --exclude '*.class' --exclude '*.jar' --exclude '*.war' --exclude '*.ear' --exclude '*.zip' --exclude '*.tar' --exclude '*.gz' /home1/furqan/my_mutation_experiments/d4j_work_diff/Cli-22-b/src/java/org/apache/commons/cli/PosixParser.java /home1/furqan/my_mutation_experiments/d4j_work_diff/Cli-22-f/src/java/org/apache/commons/cli/PosixParser.java
--- /home1/furqan/my_mutation_experiments/d4j_work_diff/Cli-22-b/src/java/org/apache/commons/cli/PosixParser.java	2025-11-02 23:01:40.809047857 +0800
+++ /home1/furqan/my_mutation_experiments/d4j_work_diff/Cli-22-f/src/java/org/apache/commons/cli/PosixParser.java	2025-11-02 23:01:43.565998772 +0800
@@ -38,6 +38,7 @@
     private boolean eatTheRest;
 
     /** holder for the current option */
+    private Option currentOption;
 
     /** the command line Options */
     private Options options;
@@ -113,10 +114,11 @@
 
                 if (!options.hasOption(opt))
                 {
-                    processNonOptionToken(token);
+                    processNonOptionToken(token, stopAtNonOption);
                 }
                 else
                 {
+                    currentOption = options.getOption(opt);
                     
                     tokens.add(opt);
                     if (pos != -1)
@@ -143,13 +145,9 @@
                     burstToken(token, stopAtNonOption);
                 }
             }
-            else if (stopAtNonOption)
-            {
-                processNonOptionToken(token);
-            }
             else
             {
-                tokens.add(token);
+                processNonOptionToken(token, stopAtNonOption);
             }
 
             gobble(iter);
@@ -181,10 +179,13 @@
      *
      * @param value The current token
      */
-    private void processNonOptionToken(String value)
+    private void processNonOptionToken(String value, boolean stopAtNonOption)
     {
+        if (stopAtNonOption && (currentOption == null || !currentOption.hasArg()))
+        {
             eatTheRest = true;
             tokens.add("--");
+        }
 
         tokens.add(value);
     }
@@ -208,6 +209,10 @@
             eatTheRest = true;
         }
 
+        if (options.hasOption(token))
+        {
+            currentOption = options.getOption(token);
+        }
 
         tokens.add(token);
     }
@@ -240,7 +245,6 @@
      */
     protected void burstToken(String token, boolean stopAtNonOption)
     {
-        Option currentOption;
         for (int i = 1; i < token.length(); i++)
         {
             String ch = String.valueOf(token.charAt(i));
@@ -259,7 +263,7 @@
             }
             else if (stopAtNonOption)
             {
-                processNonOptionToken(token.substring(i));
+                processNonOptionToken(token.substring(i), true);
                 break;
             }
             else
