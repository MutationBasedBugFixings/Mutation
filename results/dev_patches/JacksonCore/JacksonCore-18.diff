diff -ruN --exclude .git --exclude .svn --exclude .hg --exclude .idea --exclude .settings --exclude .classpath --exclude .project --exclude target --exclude build --exclude out --exclude bin --exclude '*.class' --exclude '*.jar' --exclude '*.war' --exclude '*.ear' --exclude '*.zip' --exclude '*.tar' --exclude '*.gz' /home1/furqan/my_mutation_experiments/d4j_work_diff_jacksoncore/JacksonCore-18-b/.defects4j.config /home1/furqan/my_mutation_experiments/d4j_work_diff_jacksoncore/JacksonCore-18-f/.defects4j.config
--- /home1/furqan/my_mutation_experiments/d4j_work_diff_jacksoncore/JacksonCore-18-b/.defects4j.config	2025-11-05 17:25:31.238962189 +0800
+++ /home1/furqan/my_mutation_experiments/d4j_work_diff_jacksoncore/JacksonCore-18-f/.defects4j.config	2025-11-05 17:25:32.886946804 +0800
@@ -1,3 +1,3 @@
 #File automatically generated by Defects4J
 pid=JacksonCore
-vid=18b
+vid=18f
diff -ruN --exclude .git --exclude .svn --exclude .hg --exclude .idea --exclude .settings --exclude .classpath --exclude .project --exclude target --exclude build --exclude out --exclude bin --exclude '*.class' --exclude '*.jar' --exclude '*.war' --exclude '*.ear' --exclude '*.zip' --exclude '*.tar' --exclude '*.gz' /home1/furqan/my_mutation_experiments/d4j_work_diff_jacksoncore/JacksonCore-18-b/src/main/java/com/fasterxml/jackson/core/base/GeneratorBase.java /home1/furqan/my_mutation_experiments/d4j_work_diff_jacksoncore/JacksonCore-18-f/src/main/java/com/fasterxml/jackson/core/base/GeneratorBase.java
--- /home1/furqan/my_mutation_experiments/d4j_work_diff_jacksoncore/JacksonCore-18-b/src/main/java/com/fasterxml/jackson/core/base/GeneratorBase.java	2025-11-05 17:25:31.239962180 +0800
+++ /home1/furqan/my_mutation_experiments/d4j_work_diff_jacksoncore/JacksonCore-18-f/src/main/java/com/fasterxml/jackson/core/base/GeneratorBase.java	2025-11-05 17:25:32.980945926 +0800
@@ -50,6 +50,7 @@
      * 
      * @since 2.7.7
      */
+    protected final static int MAX_BIG_DECIMAL_SCALE = 9999;
     
     /*
     /**********************************************************
@@ -431,7 +432,16 @@
      * @since 2.7.7
      */
     protected String _asString(BigDecimal value) throws IOException {
+        if (Feature.WRITE_BIGDECIMAL_AS_PLAIN.enabledIn(_features)) {
             // 24-Aug-2016, tatu: [core#315] prevent possible DoS vector
+            int scale = value.scale();
+            if ((scale < -MAX_BIG_DECIMAL_SCALE) || (scale > MAX_BIG_DECIMAL_SCALE)) {
+                _reportError(String.format(
+"Attempt to write plain `java.math.BigDecimal` (see JsonGenerator.Feature.WRITE_BIGDECIMAL_AS_PLAIN) with illegal scale (%d): needs to be between [-%d, %d]",
+scale, MAX_BIG_DECIMAL_SCALE, MAX_BIG_DECIMAL_SCALE));
+            }
+            return value.toPlainString();
+        }
         return value.toString();
     }
 
diff -ruN --exclude .git --exclude .svn --exclude .hg --exclude .idea --exclude .settings --exclude .classpath --exclude .project --exclude target --exclude build --exclude out --exclude bin --exclude '*.class' --exclude '*.jar' --exclude '*.war' --exclude '*.ear' --exclude '*.zip' --exclude '*.tar' --exclude '*.gz' /home1/furqan/my_mutation_experiments/d4j_work_diff_jacksoncore/JacksonCore-18-b/src/main/java/com/fasterxml/jackson/core/json/UTF8JsonGenerator.java /home1/furqan/my_mutation_experiments/d4j_work_diff_jacksoncore/JacksonCore-18-f/src/main/java/com/fasterxml/jackson/core/json/UTF8JsonGenerator.java
--- /home1/furqan/my_mutation_experiments/d4j_work_diff_jacksoncore/JacksonCore-18-b/src/main/java/com/fasterxml/jackson/core/json/UTF8JsonGenerator.java	2025-11-05 17:25:31.239962180 +0800
+++ /home1/furqan/my_mutation_experiments/d4j_work_diff_jacksoncore/JacksonCore-18-f/src/main/java/com/fasterxml/jackson/core/json/UTF8JsonGenerator.java	2025-11-05 17:25:32.981945917 +0800
@@ -907,10 +907,7 @@
         if (value == null) {
             _writeNull();
         } else  if (_cfgNumbersAsStrings) {
-            String raw = Feature.WRITE_BIGDECIMAL_AS_PLAIN.enabledIn(_features) ? value.toPlainString() : value.toString();
-            _writeQuotedRaw(raw);
-        } else if (Feature.WRITE_BIGDECIMAL_AS_PLAIN.enabledIn(_features)) {
-            writeRaw(value.toPlainString());
+            _writeQuotedRaw(_asString(value));
         } else {
             writeRaw(_asString(value));
         }
diff -ruN --exclude .git --exclude .svn --exclude .hg --exclude .idea --exclude .settings --exclude .classpath --exclude .project --exclude target --exclude build --exclude out --exclude bin --exclude '*.class' --exclude '*.jar' --exclude '*.war' --exclude '*.ear' --exclude '*.zip' --exclude '*.tar' --exclude '*.gz' /home1/furqan/my_mutation_experiments/d4j_work_diff_jacksoncore/JacksonCore-18-b/src/main/java/com/fasterxml/jackson/core/json/WriterBasedJsonGenerator.java /home1/furqan/my_mutation_experiments/d4j_work_diff_jacksoncore/JacksonCore-18-f/src/main/java/com/fasterxml/jackson/core/json/WriterBasedJsonGenerator.java
--- /home1/furqan/my_mutation_experiments/d4j_work_diff_jacksoncore/JacksonCore-18-b/src/main/java/com/fasterxml/jackson/core/json/WriterBasedJsonGenerator.java	2025-11-05 17:25:31.240962170 +0800
+++ /home1/furqan/my_mutation_experiments/d4j_work_diff_jacksoncore/JacksonCore-18-f/src/main/java/com/fasterxml/jackson/core/json/WriterBasedJsonGenerator.java	2025-11-05 17:25:32.981945917 +0800
@@ -684,10 +684,7 @@
         if (value == null) {
             _writeNull();
         } else  if (_cfgNumbersAsStrings) {
-            String raw = isEnabled(Feature.WRITE_BIGDECIMAL_AS_PLAIN) ? value.toPlainString() : value.toString();
-            _writeQuotedRaw(raw);
-        } else if (isEnabled(Feature.WRITE_BIGDECIMAL_AS_PLAIN)) {
-            writeRaw(value.toPlainString());
+            _writeQuotedRaw(_asString(value));
         } else {
             writeRaw(_asString(value));
         }
