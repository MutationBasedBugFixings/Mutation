diff -ruN --exclude .git --exclude .svn --exclude .hg --exclude .idea --exclude .settings --exclude .classpath --exclude .project --exclude target --exclude build --exclude out --exclude bin --exclude '*.class' --exclude '*.jar' --exclude '*.war' --exclude '*.ear' --exclude '*.zip' --exclude '*.tar' --exclude '*.gz' /home1/furqan/my_mutation_experiments/d4j_work_diff/JxPath-9-b/.defects4j.config /home1/furqan/my_mutation_experiments/d4j_work_diff/JxPath-9-f/.defects4j.config
--- /home1/furqan/my_mutation_experiments/d4j_work_diff/JxPath-9-b/.defects4j.config	2025-11-02 21:23:08.878507143 +0800
+++ /home1/furqan/my_mutation_experiments/d4j_work_diff/JxPath-9-f/.defects4j.config	2025-11-02 21:23:09.710497763 +0800
@@ -1,3 +1,3 @@
 #File automatically generated by Defects4J
 pid=JxPath
-vid=9b
+vid=9f
diff -ruN --exclude .git --exclude .svn --exclude .hg --exclude .idea --exclude .settings --exclude .classpath --exclude .project --exclude target --exclude build --exclude out --exclude bin --exclude '*.class' --exclude '*.jar' --exclude '*.war' --exclude '*.ear' --exclude '*.zip' --exclude '*.tar' --exclude '*.gz' /home1/furqan/my_mutation_experiments/d4j_work_diff/JxPath-9-b/src/java/org/apache/commons/jxpath/ri/compiler/CoreOperationCompare.java /home1/furqan/my_mutation_experiments/d4j_work_diff/JxPath-9-f/src/java/org/apache/commons/jxpath/ri/compiler/CoreOperationCompare.java
--- /home1/furqan/my_mutation_experiments/d4j_work_diff/JxPath-9-b/src/java/org/apache/commons/jxpath/ri/compiler/CoreOperationCompare.java	2025-11-02 21:23:08.879507132 +0800
+++ /home1/furqan/my_mutation_experiments/d4j_work_diff/JxPath-9-f/src/java/org/apache/commons/jxpath/ri/compiler/CoreOperationCompare.java	2025-11-02 21:23:09.833496377 +0800
@@ -34,12 +34,20 @@
  * @version $Revision$ $Date$
  */
 public abstract class CoreOperationCompare extends CoreOperation {
+    private boolean invert;
 
     public CoreOperationCompare(Expression arg1, Expression arg2) {
+        this(arg1, arg2, false);
+    }
 
+    protected CoreOperationCompare(Expression arg1, Expression arg2, boolean invert) {
         super(new Expression[] { arg1, arg2 });
+        this.invert = invert;
     }
 
+    public Object computeValue(EvalContext context) {
+        return equal(context, args[0], args[1]) ? Boolean.TRUE : Boolean.FALSE;
+    }
 
     protected int getPrecedence() {
         return 2;
@@ -120,11 +128,6 @@
     }
 
     protected boolean equal(Object l, Object r) {
-        if (l instanceof Pointer && r instanceof Pointer) {
-            if (l.equals(r)) {
-                return true;
-            }
-        }
         if (l instanceof Pointer) {
             l = ((Pointer) l).getValue();
         }
@@ -133,21 +136,28 @@
             r = ((Pointer) r).getValue();
         }
 
-        if (l == r) {
-            return true;
-        }
+        boolean result;
         if (l instanceof Boolean || r instanceof Boolean) {
-            return (InfoSetUtil.booleanValue(l) == InfoSetUtil.booleanValue(r));
-            }
+            result = l == r || InfoSetUtil.booleanValue(l) == InfoSetUtil.booleanValue(r);
+        } else if (l instanceof Number || r instanceof Number) {
             //if either side is NaN, no comparison returns true:
-        if (l instanceof Number || r instanceof Number) {
-            return (InfoSetUtil.doubleValue(l) == InfoSetUtil.doubleValue(r));
+            double ld = InfoSetUtil.doubleValue(l);
+            if (Double.isNaN(ld)) {
+                return false;
             }
+            double rd = InfoSetUtil.doubleValue(r);
+            if (Double.isNaN(rd)) {
+                return false;
+            }
+            result = ld == rd;
+        } else {
             if (l instanceof String || r instanceof String) {
-            return (
-                InfoSetUtil.stringValue(l).equals(InfoSetUtil.stringValue(r)));
+                l = InfoSetUtil.stringValue(l);
+                r = InfoSetUtil.stringValue(r);
+            }
+            result = l == r || l != null && l.equals(r);
         }
-        return l != null && l.equals(r);
+        return result ^ invert;
     }
 
 }
diff -ruN --exclude .git --exclude .svn --exclude .hg --exclude .idea --exclude .settings --exclude .classpath --exclude .project --exclude target --exclude build --exclude out --exclude bin --exclude '*.class' --exclude '*.jar' --exclude '*.war' --exclude '*.ear' --exclude '*.zip' --exclude '*.tar' --exclude '*.gz' /home1/furqan/my_mutation_experiments/d4j_work_diff/JxPath-9-b/src/java/org/apache/commons/jxpath/ri/compiler/CoreOperationEqual.java /home1/furqan/my_mutation_experiments/d4j_work_diff/JxPath-9-f/src/java/org/apache/commons/jxpath/ri/compiler/CoreOperationEqual.java
--- /home1/furqan/my_mutation_experiments/d4j_work_diff/JxPath-9-b/src/java/org/apache/commons/jxpath/ri/compiler/CoreOperationEqual.java	2025-11-02 21:23:08.879507132 +0800
+++ /home1/furqan/my_mutation_experiments/d4j_work_diff/JxPath-9-f/src/java/org/apache/commons/jxpath/ri/compiler/CoreOperationEqual.java	2025-11-02 21:23:09.833496377 +0800
@@ -28,9 +28,6 @@
         super(arg1, arg2);
     }
 
-    public Object computeValue(org.apache.commons.jxpath.ri.EvalContext context) {
-        return equal(context, args[0], args[1]) ? Boolean.TRUE : Boolean.FALSE;
-    }
     public String getSymbol() {
         return "=";
     }
diff -ruN --exclude .git --exclude .svn --exclude .hg --exclude .idea --exclude .settings --exclude .classpath --exclude .project --exclude target --exclude build --exclude out --exclude bin --exclude '*.class' --exclude '*.jar' --exclude '*.war' --exclude '*.ear' --exclude '*.zip' --exclude '*.tar' --exclude '*.gz' /home1/furqan/my_mutation_experiments/d4j_work_diff/JxPath-9-b/src/java/org/apache/commons/jxpath/ri/compiler/CoreOperationNotEqual.java /home1/furqan/my_mutation_experiments/d4j_work_diff/JxPath-9-f/src/java/org/apache/commons/jxpath/ri/compiler/CoreOperationNotEqual.java
--- /home1/furqan/my_mutation_experiments/d4j_work_diff/JxPath-9-b/src/java/org/apache/commons/jxpath/ri/compiler/CoreOperationNotEqual.java	2025-11-02 21:23:08.880507121 +0800
+++ /home1/furqan/my_mutation_experiments/d4j_work_diff/JxPath-9-f/src/java/org/apache/commons/jxpath/ri/compiler/CoreOperationNotEqual.java	2025-11-02 21:23:09.833496377 +0800
@@ -25,12 +25,9 @@
 public class CoreOperationNotEqual extends CoreOperationCompare {
 
     public CoreOperationNotEqual(Expression arg1, Expression arg2) {
-        super(arg1, arg2);
+        super(arg1, arg2, true);
     }
 
-    public Object computeValue(org.apache.commons.jxpath.ri.EvalContext context) {
-        return equal(context, args[0], args[1]) ? Boolean.FALSE : Boolean.TRUE;
-    }
     public String getSymbol() {
         return "!=";
     }
