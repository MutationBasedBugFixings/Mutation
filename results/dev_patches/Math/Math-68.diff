diff -ruN --exclude .git --exclude .svn --exclude .hg --exclude .idea --exclude .settings --exclude .classpath --exclude .project --exclude target --exclude build --exclude out --exclude bin --exclude '*.class' --exclude '*.jar' --exclude '*.war' --exclude '*.ear' --exclude '*.zip' --exclude '*.tar' --exclude '*.gz' /home1/furqan/my_mutation_experiments/d4j_work_diff_math/Math-68-b/.defects4j.config /home1/furqan/my_mutation_experiments/d4j_work_diff_math/Math-68-f/.defects4j.config
--- /home1/furqan/my_mutation_experiments/d4j_work_diff_math/Math-68-b/.defects4j.config	2025-11-09 16:46:00.854469520 +0800
+++ /home1/furqan/my_mutation_experiments/d4j_work_diff_math/Math-68-f/.defects4j.config	2025-11-09 16:46:05.166497625 +0800
@@ -1,3 +1,3 @@
 #File automatically generated by Defects4J
 pid=Math
-vid=68b
+vid=68f
diff -ruN --exclude .git --exclude .svn --exclude .hg --exclude .idea --exclude .settings --exclude .classpath --exclude .project --exclude target --exclude build --exclude out --exclude bin --exclude '*.class' --exclude '*.jar' --exclude '*.war' --exclude '*.ear' --exclude '*.zip' --exclude '*.tar' --exclude '*.gz' /home1/furqan/my_mutation_experiments/d4j_work_diff_math/Math-68-b/src/main/java/org/apache/commons/math/optimization/general/LevenbergMarquardtOptimizer.java /home1/furqan/my_mutation_experiments/d4j_work_diff_math/Math-68-f/src/main/java/org/apache/commons/math/optimization/general/LevenbergMarquardtOptimizer.java
--- /home1/furqan/my_mutation_experiments/d4j_work_diff_math/Math-68-b/src/main/java/org/apache/commons/math/optimization/general/LevenbergMarquardtOptimizer.java	2025-11-09 16:46:00.855469527 +0800
+++ /home1/furqan/my_mutation_experiments/d4j_work_diff_math/Math-68-f/src/main/java/org/apache/commons/math/optimization/general/LevenbergMarquardtOptimizer.java	2025-11-09 16:46:05.244498127 +0800
@@ -163,6 +163,7 @@
         setMaxIterations(1000);
 
         // default values for the tuning parameters
+        setConvergenceChecker(null);
         setInitialStepBoundFactor(100.0);
         setCostRelativeTolerance(1.0e-10);
         setParRelativeTolerance(1.0e-10);
@@ -244,11 +245,13 @@
         // outer loop
         lmPar = 0;
         boolean firstIteration = true;
+        VectorialPointValuePair current = new VectorialPointValuePair(point, objective);
         while (true) {
 
             incrementIterationsCounter();
 
             // compute the Q.R. decomposition of the jacobian matrix
+            VectorialPointValuePair previous = current;
             updateJacobian();
             qrDecomposition();
 
@@ -300,7 +303,7 @@
             }
             if (maxCosine <= orthoTolerance) {
                 // convergence has been reached
-                return new VectorialPointValuePair(point, objective);
+                return current;
             }
 
             // rescale if necessary
@@ -342,6 +345,7 @@
 
                 // evaluate the function at x + p and calculate its norm
                 updateResidualsAndCost();
+                current = new VectorialPointValuePair(point, objective);
 
                 // compute the scaled actual reduction
                 double actRed = -1.0;
@@ -410,14 +414,20 @@
                 }
 
                 // tests for convergence.
+                if (checker != null) {
                     // we use the vectorial convergence checker
+                    if (checker.converged(getIterations(), previous, current)) {
+                        return current;                        
+                    }
+                } else {
                     // we use the Levenberg-Marquardt specific convergence parameters
                     if (((Math.abs(actRed) <= costRelativeTolerance) &&
                          (preRed <= costRelativeTolerance) &&
                          (ratio <= 2.0)) ||
                         (delta <= parRelativeTolerance * xNorm)) {
-                        return new VectorialPointValuePair(point, objective);
+                        return current;
                     }
+                }
 
                 // tests for termination and stringent tolerances
                 // (2.2204e-16 is the machine epsilon for IEEE754)
