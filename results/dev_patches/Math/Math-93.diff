diff -ruN --exclude .git --exclude .svn --exclude .hg --exclude .idea --exclude .settings --exclude .classpath --exclude .project --exclude target --exclude build --exclude out --exclude bin --exclude '*.class' --exclude '*.jar' --exclude '*.war' --exclude '*.ear' --exclude '*.zip' --exclude '*.tar' --exclude '*.gz' /home1/furqan/my_mutation_experiments/d4j_work_diff_math/Math-93-b/.defects4j.config /home1/furqan/my_mutation_experiments/d4j_work_diff_math/Math-93-f/.defects4j.config
--- /home1/furqan/my_mutation_experiments/d4j_work_diff_math/Math-93-b/.defects4j.config	2025-11-09 16:49:37.356259454 +0800
+++ /home1/furqan/my_mutation_experiments/d4j_work_diff_math/Math-93-f/.defects4j.config	2025-11-09 16:49:41.342263671 +0800
@@ -1,3 +1,3 @@
 #File automatically generated by Defects4J
 pid=Math
-vid=93b
+vid=93f
diff -ruN --exclude .git --exclude .svn --exclude .hg --exclude .idea --exclude .settings --exclude .classpath --exclude .project --exclude target --exclude build --exclude out --exclude bin --exclude '*.class' --exclude '*.jar' --exclude '*.war' --exclude '*.ear' --exclude '*.zip' --exclude '*.tar' --exclude '*.gz' /home1/furqan/my_mutation_experiments/d4j_work_diff_math/Math-93-b/src/java/org/apache/commons/math/util/MathUtils.java /home1/furqan/my_mutation_experiments/d4j_work_diff_math/Math-93-f/src/java/org/apache/commons/math/util/MathUtils.java
--- /home1/furqan/my_mutation_experiments/d4j_work_diff_math/Math-93-b/src/java/org/apache/commons/math/util/MathUtils.java	2025-11-09 16:49:37.356259454 +0800
+++ /home1/furqan/my_mutation_experiments/d4j_work_diff_math/Math-93-f/src/java/org/apache/commons/math/util/MathUtils.java	2025-11-09 16:49:41.415263746 +0800
@@ -342,8 +342,10 @@
      * @throws IllegalArgumentException if n < 0
      */
     public static long factorial(final int n) {
-        long result = Math.round(factorialDouble(n));
-        if (result == Long.MAX_VALUE) {
+        if (n < 0) {
+            throw new IllegalArgumentException("must have n >= 0 for n!");
+        }
+        if (n > 20) {
             throw new ArithmeticException(
                     "factorial value is too large to fit in a long");
         }
@@ -374,6 +376,9 @@
         if (n < 0) {
             throw new IllegalArgumentException("must have n >= 0 for n!");
         }
+        if (n < 21) {
+            return factorial(n);
+        }
         return Math.floor(Math.exp(factorialLog(n)) + 0.5);
     }
 
@@ -394,6 +399,9 @@
         if (n < 0) {
             throw new IllegalArgumentException("must have n > 0 for n!");
         }
+        if (n < 21) {
+            return Math.log(factorial(n));
+        }
         double logSum = 0;
         for (int i = 2; i <= n; i++) {
             logSum += Math.log((double)i);
