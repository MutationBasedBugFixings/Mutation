diff -ruN --exclude .git --exclude .svn --exclude .hg --exclude .idea --exclude .settings --exclude .classpath --exclude .project --exclude target --exclude build --exclude out --exclude bin --exclude '*.class' --exclude '*.jar' --exclude '*.war' --exclude '*.ear' --exclude '*.zip' --exclude '*.tar' --exclude '*.gz' /home1/furqan/my_mutation_experiments/d4j_work_diff_math/Math-102-b/.defects4j.config /home1/furqan/my_mutation_experiments/d4j_work_diff_math/Math-102-f/.defects4j.config
--- /home1/furqan/my_mutation_experiments/d4j_work_diff_math/Math-102-b/.defects4j.config	2025-11-09 16:50:53.380286959 +0800
+++ /home1/furqan/my_mutation_experiments/d4j_work_diff_math/Math-102-f/.defects4j.config	2025-11-09 16:50:57.434285440 +0800
@@ -1,3 +1,3 @@
 #File automatically generated by Defects4J
 pid=Math
-vid=102b
+vid=102f
diff -ruN --exclude .git --exclude .svn --exclude .hg --exclude .idea --exclude .settings --exclude .classpath --exclude .project --exclude target --exclude build --exclude out --exclude bin --exclude '*.class' --exclude '*.jar' --exclude '*.war' --exclude '*.ear' --exclude '*.zip' --exclude '*.tar' --exclude '*.gz' /home1/furqan/my_mutation_experiments/d4j_work_diff_math/Math-102-b/src/java/org/apache/commons/math/stat/inference/ChiSquareTestImpl.java /home1/furqan/my_mutation_experiments/d4j_work_diff_math/Math-102-f/src/java/org/apache/commons/math/stat/inference/ChiSquareTestImpl.java
--- /home1/furqan/my_mutation_experiments/d4j_work_diff_math/Math-102-b/src/java/org/apache/commons/math/stat/inference/ChiSquareTestImpl.java	2025-11-09 16:50:53.381286959 +0800
+++ /home1/furqan/my_mutation_experiments/d4j_work_diff_math/Math-102-f/src/java/org/apache/commons/math/stat/inference/ChiSquareTestImpl.java	2025-11-09 16:50:57.494285415 +0800
@@ -71,11 +71,28 @@
             throw new IllegalArgumentException(
                 "observed counts must be non-negative and expected counts must be postive");
         }
+        double sumExpected = 0d;
+        double sumObserved = 0d;
+        for (int i = 0; i < observed.length; i++) {
+            sumExpected += expected[i];
+            sumObserved += observed[i];
+        }
+        double ratio = 1.0d;
+        boolean rescale = false;
+        if (Math.abs(sumExpected - sumObserved) > 10E-6) {
+            ratio = sumObserved / sumExpected;
+            rescale = true;
+        }
         double sumSq = 0.0d;
         double dev = 0.0d;
         for (int i = 0; i < observed.length; i++) {
+            if (rescale) {
+                dev = ((double) observed[i] - ratio * expected[i]);
+                sumSq += dev * dev / (ratio * expected[i]);
+            } else {
                 dev = ((double) observed[i] - expected[i]);
                 sumSq += dev * dev / expected[i];
+            }
         }
         return sumSq;
     }
