diff -ruN --exclude .git --exclude .svn --exclude .hg --exclude .idea --exclude .settings --exclude .classpath --exclude .project --exclude target --exclude build --exclude out --exclude bin --exclude '*.class' --exclude '*.jar' --exclude '*.war' --exclude '*.ear' --exclude '*.zip' --exclude '*.tar' --exclude '*.gz' /home1/furqan/my_mutation_experiments/d4j_work_diff_jacksondatabind/JacksonDatabind-30-b/.defects4j.config /home1/furqan/my_mutation_experiments/d4j_work_diff_jacksondatabind/JacksonDatabind-30-f/.defects4j.config
--- /home1/furqan/my_mutation_experiments/d4j_work_diff_jacksondatabind/JacksonDatabind-30-b/.defects4j.config	2025-11-08 12:13:48.617519140 +0800
+++ /home1/furqan/my_mutation_experiments/d4j_work_diff_jacksondatabind/JacksonDatabind-30-f/.defects4j.config	2025-11-08 12:13:54.709730333 +0800
@@ -1,3 +1,3 @@
 #File automatically generated by Defects4J
 pid=JacksonDatabind
-vid=30b
+vid=30f
diff -ruN --exclude .git --exclude .svn --exclude .hg --exclude .idea --exclude .settings --exclude .classpath --exclude .project --exclude target --exclude build --exclude out --exclude bin --exclude '*.class' --exclude '*.jar' --exclude '*.war' --exclude '*.ear' --exclude '*.zip' --exclude '*.tar' --exclude '*.gz' /home1/furqan/my_mutation_experiments/d4j_work_diff_jacksondatabind/JacksonDatabind-30-b/src/main/java/com/fasterxml/jackson/databind/ObjectMapper.java /home1/furqan/my_mutation_experiments/d4j_work_diff_jacksondatabind/JacksonDatabind-30-f/src/main/java/com/fasterxml/jackson/databind/ObjectMapper.java
--- /home1/furqan/my_mutation_experiments/d4j_work_diff_jacksondatabind/JacksonDatabind-30-b/src/main/java/com/fasterxml/jackson/databind/ObjectMapper.java	2025-11-08 12:13:48.620519244 +0800
+++ /home1/furqan/my_mutation_experiments/d4j_work_diff_jacksondatabind/JacksonDatabind-30-f/src/main/java/com/fasterxml/jackson/databind/ObjectMapper.java	2025-11-08 12:13:54.807733711 +0800
@@ -2507,6 +2507,9 @@
     {
         if (fromValue == null) return null;
         TokenBuffer buf = new TokenBuffer(this, false);
+        if (isEnabled(DeserializationFeature.USE_BIG_DECIMAL_FOR_FLOATS)) {
+            buf = buf.forceUseOfBigDecimal(true);
+        }
         JsonNode result;
         try {
             writeValue(buf, fromValue);
@@ -3423,6 +3426,9 @@
         
         // Then use TokenBuffer, which is a JsonGenerator:
         TokenBuffer buf = new TokenBuffer(this, false);
+        if (isEnabled(DeserializationFeature.USE_BIG_DECIMAL_FOR_FLOATS)) {
+            buf = buf.forceUseOfBigDecimal(true);
+        }
         try {
             // inlined 'writeValue' with minor changes:
             // first: disable wrapping when writing
diff -ruN --exclude .git --exclude .svn --exclude .hg --exclude .idea --exclude .settings --exclude .classpath --exclude .project --exclude target --exclude build --exclude out --exclude bin --exclude '*.class' --exclude '*.jar' --exclude '*.war' --exclude '*.ear' --exclude '*.zip' --exclude '*.tar' --exclude '*.gz' /home1/furqan/my_mutation_experiments/d4j_work_diff_jacksondatabind/JacksonDatabind-30-b/src/main/java/com/fasterxml/jackson/databind/util/TokenBuffer.java /home1/furqan/my_mutation_experiments/d4j_work_diff_jacksondatabind/JacksonDatabind-30-f/src/main/java/com/fasterxml/jackson/databind/util/TokenBuffer.java
--- /home1/furqan/my_mutation_experiments/d4j_work_diff_jacksondatabind/JacksonDatabind-30-b/src/main/java/com/fasterxml/jackson/databind/util/TokenBuffer.java	2025-11-08 12:13:48.625519419 +0800
+++ /home1/furqan/my_mutation_experiments/d4j_work_diff_jacksondatabind/JacksonDatabind-30-f/src/main/java/com/fasterxml/jackson/databind/util/TokenBuffer.java	2025-11-08 12:13:54.812733884 +0800
@@ -77,6 +77,7 @@
      *
      * @since 2.7
      */
+    protected boolean _forceBigDecimal;
     
     /*
     /**********************************************************
@@ -185,11 +186,17 @@
         _hasNativeTypeIds = p.canReadTypeId();
         _hasNativeObjectIds = p.canReadObjectId();
         _mayHaveNativeIds = _hasNativeTypeIds | _hasNativeObjectIds;
+        _forceBigDecimal = (ctxt == null) ? false
+                : ctxt.isEnabled(DeserializationFeature.USE_BIG_DECIMAL_FOR_FLOATS);
     }
 
     /**
      * @since 2.7
      */
+    public TokenBuffer forceUseOfBigDecimal(boolean b) {
+        _forceBigDecimal = b;
+        return this;
+    }
 
     @Override
     public Version version() {
@@ -956,11 +963,14 @@
             }
             break;
         case VALUE_NUMBER_FLOAT:
+            if (_forceBigDecimal) {
                 /* 10-Oct-2015, tatu: Ideally we would first determine whether underlying
                  *   number is already decoded into a number (in which case might as well
                  *   access as number); or is still retained as text (in which case we
                  *   should further defer decoding that may not need BigDecimal):
                  */
+                writeNumber(p.getDecimalValue());
+            } else {
                 switch (p.getNumberType()) {
                 case BIG_DECIMAL:
                     writeNumber(p.getDecimalValue());
@@ -970,6 +980,7 @@
                     break;
                 default:
                     writeNumber(p.getDoubleValue());
+                }
             }
             break;
         case VALUE_TRUE:
